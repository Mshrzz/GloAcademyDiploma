(()=>{"use strict";var e,t,n,o,l,r,s,a,c,i;e=document.querySelector(".club-select").querySelector("ul"),t=document.getElementById("free_visit_form"),n=document.getElementById("callback_form"),document.body.addEventListener("click",(function(o){var l=o.target;l.closest(".club-select")?e.style.display="block":l.closest(".club-select")||(e.style.display="none"),l.closest('[data-popup="#free_visit_form"]')?t.style.display="block":!l.closest(".close-form")&&l.closest(".form-wrapper")||(t.style.display="none"),l.closest('[data-popup="#callback_form"]')&&!l.closest("form")?n.style.display="block":!l.closest(".close-form")&&l.closest(".form-wrapper")||(n.style.display="none")})),o="Что-то пошло не так.",l="Спасибо! Мы с вами свяжемся.",(r=document.createElement("div")).style.cssText="font-size: 1.5em; margin-top: 5px; margin-bottom: 5px;",document.body.addEventListener("submit",(function(e){if(e.preventDefault(),e.target.querySelector('[type="checkbox"]')&&!e.target.querySelector('[type="checkbox"]').checked){var t=e.target.querySelector(".personal-data"),n=document.createElement("p");return n.style.cssText="color: red; font-size: 1.2em; margin: 5px 0;",n.textContent="Вы должны подтвердить согласие",t.append(n),e.target.querySelector('[type="submit"]').disabled=!0,void setTimeout((function(){n.style.display="none",e.target.querySelector('[type="submit"]').disabled=!1}),1e3)}var s=e.target.querySelector('[type="tel"]'),a=s.value.match(/^\+/)&&s.value.length<12,c=s.value.match(/^(7|8)/)&&s.value.length<11,i=s.value.length<11;if(a||c||i)return e.target.querySelector('[type="tel"]').setCustomValidity("Недостаточно символов для номера телефона"),void e.target.querySelector('[type="tel"]').addEventListener("blur",(function(){12===this.value.length&&this.setCustomValidity("")}),!1);r.style.color="#ffd11a",e.target.appendChild(r),r.textContent="Загрузка...";var u=new FormData(e.target),d={};u.forEach((function(e,t){d[t]=e})),function(e){return fetch("./server.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}(d).then((function(e){if(200!==e.status)throw new Error("Network status is not 200")})).then((function(){if(e.target.closest(".form-content")){e.target.querySelectorAll("input").forEach((function(e){return e.value=""})),e.target.closest("form").style.display="none";var t=document.createElement("div"),n=document.createElement("img");t.style.cssText="display: block; color: #fff; margin: auto; margin-top: 50px; font-size: 1.5em; max-width: 200px;",n.src="./images/success.svg",n.style.cssText="display: block; width: 100px; height: 100px; margin: auto; margin-bottom: 10px;",t.append(n),t.append(l),e.target.closest(".form-content").appendChild(t),setTimeout((function(){t.style.display="none",e.target.closest("form").style.display="block"}),1500)}else e.target.querySelectorAll("input").forEach((function(e){return e.value=""})),e.target.querySelectorAll("input").forEach((function(e){return e.style.border="2px solid green"})),r.textContent=l,setTimeout((function(){return e.target.querySelectorAll("input").forEach((function(e){return e.style.border="none"}))}),1500),document.getElementById("thanks").style.display="flex",document.body.addEventListener("click",(function(e){(e.target.closest(".close-form")||!e.target.closest(".form-wrapper")||e.target.matches(".close-btn"))&&(document.getElementById("thanks").style.display="none")}))})).catch((function(t){if(e.target.closest(".form-content")){e.target.querySelectorAll("input").forEach((function(e){return e.value=""})),e.target.closest("form").style.display="none";var n=document.createElement("div"),l=document.createElement("img");n.style.cssText="display: block; color: #fff; margin: auto; margin-top: 50px; font-size: 1.5em; max-width: 200px;",l.src="./images/warning.svg",l.style.cssText="display: block; width: 100px; height: 100px; margin: auto; margin-bottom: 10px;",n.append(l),n.append(o),e.target.closest(".form-content").appendChild(n),setTimeout((function(){n.style.display="none",e.target.closest("form").style.display="block"}),1500)}else{e.target.querySelectorAll("input").forEach((function(e){return e.value=""})),e.target.querySelectorAll("input").forEach((function(e){return e.style.border="2px solid red"})),r.textContent=o,setTimeout((function(){return e.target.querySelectorAll("input").forEach((function(e){return e.style.border="none"}))}),1500);var s=document.createElement("h4"),a=document.createElement("p");s.textContent="Произошла ошибка!",a.innerHTML="Данные не получилось отправить.<br>Попробуйте ещё раз.",s.classList.add("error-message-head"),a.classList.add("error-message-content"),document.getElementById("thanks").querySelector("h4").style.display="none",document.getElementById("thanks").querySelector("p").style.display="none",document.getElementById("thanks").querySelector(".form-content").insertAdjacentElement("afterbegin",a),document.getElementById("thanks").querySelector(".form-content").insertAdjacentElement("afterbegin",s),document.getElementById("thanks").style.display="flex",document.body.addEventListener("click",(function(e){(e.target.closest(".close-form")||!e.target.closest(".form-wrapper")||e.target.matches(".close-btn"))&&(document.getElementById("thanks").style.display="none",s.remove(),a.remove(),document.getElementById("thanks").querySelector("h4").style.display="block",document.getElementById("thanks").querySelector("p").style.display="block")}))}console.error(t)})).finally((function(){setTimeout((function(){r.textContent=""}),1500)}))})),document.body.addEventListener("input",(function(e){var t=e.target;t.closest(".price-message")&&(t.value=t.value.replace(/[^0-9а-яё\- ]/gi,"")),t.matches('[name="name"]')&&!t.closest(".price-message")&&(t.value=t.value.replace(/[^а-яё\-\ ]/gi,"")),t.matches('[name="phone"]')&&(t.value.match(/^\+/)&&(t.value=t.value.substring(0,12)),t.value.match(/^(7|8)/)&&(t.value=t.value.substring(0,11)),t.value=t.value.replace(/[^\d\(\)\-\+]/,""))})),s=document.getElementById("gift"),a=document.querySelector(".fixed-gift"),document.body.addEventListener("click",(function(e){e.target.closest(".fixed-gift")?(s.style.display="block",a.style.display="none"):(e.target.closest(".close-form")||!e.target.closest(".form-wrapper")||e.target.matches(".close-btn"))&&(s.style.display="none")})),c=document.querySelector(".main-slider").children,i=0,setInterval((function(){c[i].style.display="none",++i>=c.length&&(i=0),c[i].style.display="flex"}),3e3)})();